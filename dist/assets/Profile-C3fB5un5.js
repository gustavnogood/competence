import{u as f,A as g,g as p,j as e}from"./index-oTD0Ye3R.js";import{r as u}from"./react-Da8D78aN.js";import{A as m,U as x}from"./UnauthenticatedTemplate-BL9_lnmX.js";import j from"./Login-B6f74STk.js";import{a as A}from"./axiosInstance-1FSfQN3n.js";import"./axios-Bo0ATomq.js";/*! @azure/msal-react v2.0.12 2024-02-17 */function h(n,s){return!s||!s.homeAccountId&&!s.localAccountId&&!s.username?n.getActiveAccount():p(n.getAllAccounts(),s)}function y(n){const{instance:s,inProgress:t,logger:r}=f(),[i,a]=u.useState(()=>h(s,n));return u.useEffect(()=>{a(l=>{const o=h(s,n);return g.accountInfoIsEqual(l,o,!0)?l:(r.info("useAccount - Updating account"),o)})},[t,n,s,r]),i}const T="_Container_1rrod_1",E={Container:T};function P({inProgress:n,accounts:s}){return s.length>0?e.jsxs("span",{children:["There are currently ",s.length," users signed in!"]}):n==="login"?e.jsx("span",{children:"Login is currently in progress!"}):e.jsx("span",{children:"There are currently no users signed in!"})}function v({apiData:n,addUserToDB:s}){return e.jsxs("div",{children:[n&&e.jsxs("p",{children:["Display Name: ",n.displayName," ",e.jsx("br",{}),"ID: ",n.id]}),e.jsx("button",{onClick:()=>s(n,"1"),children:"Add user to DB"})]})}function d(n,s){let t;n&&n.id&&n.displayName&&(t={id:n.id,displayName:n.displayName,nodeId:s}),t&&(console.log(t),A.post("users",t).then(r=>console.log(r)).catch(r=>console.error(r)))}function C(){const{instance:n,accounts:s,inProgress:t}=f(),r=y(s[0]||{}),[i,a]=u.useState(null);function l(o){return fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:`Bearer ${o}`}}).then(c=>c.json()).catch(c=>{throw console.error("Error calling Microsoft Graph API:",c),c})}return d(i,"1"),u.useEffect(()=>{r&&n.acquireTokenSilent({scopes:["User.Read"],account:r}).then(o=>{o&&l(o.accessToken).then(c=>a(c))})},[r,n]),s.length>0?e.jsxs("div",{className:E.Container,children:[e.jsx(P,{inProgress:t,accounts:s}),e.jsx(v,{apiData:i,addUserToDB:d})]}):t==="login"?e.jsx("span",{children:"Login is currently in progress!"}):e.jsx("span",{children:"There are currently no users signed in!"})}function k(){return e.jsxs(e.Fragment,{children:[e.jsxs(m,{children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Profile"}),e.jsx("p",{children:"Welcome to your profile!"})]}),e.jsx(C,{})]}),e.jsx(x,{children:e.jsxs("div",{children:[e.jsx("h1",{children:"Profile"}),e.jsx("p",{children:"You need to login to see the secret message"}),e.jsx(j,{})]})})]})}export{k as Profile,k as default};
