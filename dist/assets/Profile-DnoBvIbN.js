import{u as h,A as g,g as f,j as r}from"./index-DPmI-3rG.js";import{r as u}from"./react-Da8D78aN.js";import{A as x,U as m}from"./UnauthenticatedTemplate-CioPodRc.js";import j from"./Login-C7zx_aQz.js";import{a as y,u as A,b as E,R as w}from"./RoadmapTree-B2WxYR8O.js";import"./axios-Bo0ATomq.js";/*! @azure/msal-react v2.0.12 2024-02-17 */function d(e,s){return!s||!s.homeAccountId&&!s.localAccountId&&!s.username?e.getActiveAccount():f(e.getAllAccounts(),s)}function U(e){const{instance:s,inProgress:t,logger:n}=h(),[i,a]=u.useState(()=>d(s,e));return u.useEffect(()=>{a(c=>{const o=d(s,e);return g.accountInfoIsEqual(c,o,!0)?c:(n.info("useAccount - Updating account"),o)})},[t,e,s,n]),i}const T=e=>({type:"SET_USER",payload:e}),v="_Container_1dw7t_1",N={Container:v};function P({inProgress:e,accounts:s}){return s.length>0?r.jsxs("span",{children:["There are currently ",s.length," users signed in!"]}):e==="login"?r.jsx("span",{children:"Login is currently in progress!"}):r.jsx("span",{children:"There are currently no users signed in!"})}function p(e,s){if(!e||!e.id||!e.displayName){console.error("Invalid user data");return}const t={id:e.id,displayName:e.displayName,nodeId:s};y.post("users",t).then(n=>console.log(n)).catch(n=>console.error("Error adding user to DB:",n))}function k({apiData:e}){return r.jsxs("div",{children:[e?r.jsxs("p",{children:["Display Name: ",e.displayName," ",r.jsx("br",{}),"ID: ",e.id]}):r.jsx("p",{children:"No user data available"}),r.jsx("button",{onClick:()=>p(e,"1"),children:"Add user to DB"})]})}const C=async e=>{try{const s=await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:`Bearer ${e}`}});if(!s.ok)throw new Error("Network response was not ok");return await s.json()}catch(s){throw console.error("Error calling Microsoft Graph API:",s),s}};function R(){const{instance:e,accounts:s,inProgress:t}=h(),n=U(s[0]||{}),i=A(),a=E(c=>c.user.userData);return u.useEffect(()=>{(async()=>{if(n)try{const o=await e.acquireTokenSilent({scopes:["User.Read"],account:n}),l=await C(o.accessToken);console.log("Fetched user data:",l),i(T(l)),p(l,"1")}catch(o){console.error("Error fetching user data:",o)}})()},[n,e,i]),s.length>0?r.jsxs("div",{className:N.Container,children:[r.jsx(P,{inProgress:t,accounts:s}),r.jsx(k,{apiData:a}),r.jsx(w,{})]}):t==="login"?r.jsx("span",{children:"Login is currently in progress!"}):r.jsx("span",{children:"There are currently no users signed in!"})}function _(){return r.jsxs(r.Fragment,{children:[r.jsxs(x,{children:[r.jsxs("div",{children:[r.jsx("h1",{children:"Profile"}),r.jsx("p",{children:"Welcome to your profile!"})]}),r.jsx(R,{})]}),r.jsx(m,{children:r.jsxs("div",{children:[r.jsx("h1",{children:"Profile"}),r.jsx("p",{children:"You need to login to see the secret message"}),r.jsx(j,{})]})})]})}export{_ as Profile,_ as default};
