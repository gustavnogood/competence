import{u as p,A as m,g as f,j as e}from"./index-DM_2uEaQ.js";import{r as l}from"./react-Da8D78aN.js";import{A as g,U as x}from"./UnauthenticatedTemplate-CzSZeXnP.js";import j from"./Login-CamZk7Yb.js";import{a as A}from"./axiosInstance-Dgkebl2b.js";import"./axios-Bo0ATomq.js";/*! @azure/msal-react v2.0.12 2024-02-17 */function h(r,n){return!n||!n.homeAccountId&&!n.localAccountId&&!n.username?r.getActiveAccount():f(r.getAllAccounts(),n)}function y(r){const{instance:n,inProgress:u,logger:c}=p(),[s,d]=l.useState(()=>h(n,r));return l.useEffect(()=>{d(i=>{const a=h(n,r);return m.accountInfoIsEqual(i,a,!0)?i:(c.info("useAccount - Updating account"),a)})},[u,r,n,c]),s}const D="_Container_1rrod_1",E={Container:D};function P(){const{instance:r,accounts:n,inProgress:u}=p(),c=y(n[0]||{}),[s,d]=l.useState(null);function i(o){return fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:`Bearer ${o}`}}).then(t=>t.json()).catch(t=>{throw console.error("Error calling Microsoft Graph API:",t),t})}function a(){let o;s&&s.id&&s.displayName&&(o={id:s.id,displayName:s.displayName}),o?(console.log(o),A.post("users",o).then(t=>console.log(t)).catch(t=>console.error("Error adding user to DB:",t.response.data))):console.error("invalid apiData:",s)}return l.useEffect(()=>{c&&r.acquireTokenSilent({scopes:["User.Read"],account:c}).then(o=>{o&&i(o.accessToken).then(t=>d(t))})},[c,r]),n.length>0?e.jsxs("div",{className:E.Container,children:["There are currently ",n.length," users signed in!",s&&e.jsxs("p",{children:["Display Name: ",s.displayName," ",e.jsx("br",{}),"ID: ",s.id]}),e.jsx("button",{onClick:a,children:"Add user to DB"})]}):u==="login"?e.jsx("span",{children:"Login is currently in progress!"}):e.jsx("span",{children:"There are currently no users signed in!"})}function M(){return e.jsxs(e.Fragment,{children:[e.jsxs(g,{children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Profile"}),e.jsx("p",{children:"Welcome to your profile!"})]}),e.jsx(P,{})]}),e.jsx(x,{children:e.jsxs("div",{children:[e.jsx("h1",{children:"Profile"}),e.jsx("p",{children:"You need to login to see the secret message"}),e.jsx(j,{})]})})]})}export{M as Profile,M as default};
