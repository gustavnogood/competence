import{j as e,u as h}from"./index-DO6X-sjb.js";import{r as p}from"./react-D7GvDG4H.js";import{A as f,U as x}from"./UnauthenticatedTemplate-DABJJpzd.js";import m from"./Login-rfuM6RIp.js";import{a as j,u as g,b as y,c as w,R as E}from"./RoadmapTree-CBgxIKbA.js";import"./axios-Bo0ATomq.js";const T=s=>({type:"SET_USER",payload:s}),U="_Container_1dw7t_1",A={Container:U};function N({inProgress:s,accounts:r}){return r.length>0?e.jsxs("span",{children:["There are currently ",r.length," users signed in!"]}):s==="login"?e.jsx("span",{children:"Login is currently in progress!"}):e.jsx("span",{children:"There are currently no users signed in!"})}function d(s,r){if(!s||!s.id||!s.displayName){console.error("Invalid user data");return}const o={id:s.id,displayName:s.displayName,nodeId:r};j.post("users",o).then(n=>console.log(n)).catch(n=>console.error("Error adding user to DB:",n))}function v({apiData:s}){return e.jsxs("div",{children:[s?e.jsxs("p",{children:["Display Name: ",s.displayName," ",e.jsx("br",{}),"ID: ",s.id]}):e.jsx("p",{children:"No user data available"}),e.jsx("button",{onClick:()=>d(s,"1"),children:"Add user to DB"})]})}const k=async s=>{try{const r=await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:`Bearer ${s}`}});if(!r.ok)throw new Error("Network response was not ok");return await r.json()}catch(r){throw console.error("Error calling Microsoft Graph API:",r),r}};function C(){const{instance:s,accounts:r,inProgress:o}=h(),n=g(r[0]||{}),a=y(),u=w(c=>c.user.userData);return p.useEffect(()=>{(async()=>{if(n)try{const t=await s.acquireTokenSilent({scopes:["User.Read"],account:n}),i=await k(t.accessToken);console.log("Fetched user data:",i);const l="some-node-id";a(T({...i,nodeId:l})),d({...i,nodeId:l},"1")}catch(t){console.error("Error fetching user data:",t)}})()},[n,s,a]),r.length>0?e.jsxs("div",{className:A.Container,children:[e.jsx(N,{inProgress:o,accounts:r}),e.jsx(v,{apiData:u}),e.jsx(E,{})]}):o==="login"?e.jsx("span",{children:"Login is currently in progress!"}):e.jsx("span",{children:"There are currently no users signed in!"})}function b(){return e.jsxs(e.Fragment,{children:[e.jsxs(f,{children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Profile"}),e.jsx("p",{children:"Welcome to your profile!"})]}),e.jsx(C,{})]}),e.jsx(x,{children:e.jsxs("div",{children:[e.jsx("h1",{children:"Profile"}),e.jsx("p",{children:"You need to login to see the secret message"}),e.jsx(m,{})]})})]})}export{b as Profile,b as default};
