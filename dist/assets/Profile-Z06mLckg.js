import{u as h,A as f,g,j as e}from"./index-DZTrF67c.js";import{r as c}from"./react-Da8D78aN.js";import{A as x,U as m}from"./UnauthenticatedTemplate-CLg0yTux.js";import j from"./Login-CAL6Ert9.js";import{a as y}from"./axiosInstance-1FSfQN3n.js";import"./axios-Bo0ATomq.js";/*! @azure/msal-react v2.0.12 2024-02-17 */function d(r,s){return!s||!s.homeAccountId&&!s.localAccountId&&!s.username?r.getActiveAccount():g(r.getAllAccounts(),s)}function A(r){const{instance:s,inProgress:t,logger:n}=h(),[i,a]=c.useState(()=>d(s,r));return c.useEffect(()=>{a(l=>{const o=d(s,r);return f.accountInfoIsEqual(l,o,!0)?l:(n.info("useAccount - Updating account"),o)})},[t,r,s,n]),i}const w="_Container_1dw7t_1",E={Container:w};function U({inProgress:r,accounts:s}){return s.length>0?e.jsxs("span",{children:["There are currently ",s.length," users signed in!"]}):r==="login"?e.jsx("span",{children:"Login is currently in progress!"}):e.jsx("span",{children:"There are currently no users signed in!"})}function p(r,s){if(!r||!r.id||!r.displayName){console.error("Invalid user data");return}const t={id:r.id,displayName:r.displayName,nodeId:s};y.post("users",t).then(n=>console.log(n)).catch(n=>console.error("Error adding user to DB:",n))}function v({apiData:r}){return e.jsxs("div",{children:[r?e.jsxs("p",{children:["Display Name: ",r.displayName," ",e.jsx("br",{}),"ID: ",r.id]}):e.jsx("p",{children:"No user data available"}),e.jsx("button",{onClick:()=>p(r,"1"),children:"Add user to DB"})]})}const N=async r=>{try{const s=await fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:`Bearer ${r}`}});if(!s.ok)throw new Error("Network response was not ok");return await s.json()}catch(s){throw console.error("Error calling Microsoft Graph API:",s),s}};function T(){const{instance:r,accounts:s,inProgress:t}=h(),n=A(s[0]||{}),[i,a]=c.useState(null);return c.useEffect(()=>{(async()=>{if(n)try{const o=await r.acquireTokenSilent({scopes:["User.Read"],account:n}),u=await N(o.accessToken);a(u),p(u,"1")}catch(o){console.error("Error fetching user data:",o)}})()},[n,r]),s.length>0?e.jsxs("div",{className:E.Container,children:[e.jsx(U,{inProgress:t,accounts:s}),e.jsx(v,{apiData:i})]}):t==="login"?e.jsx("span",{children:"Login is currently in progress!"}):e.jsx("span",{children:"There are currently no users signed in!"})}function M(){return e.jsxs(e.Fragment,{children:[e.jsxs(x,{children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Profile"}),e.jsx("p",{children:"Welcome to your profile!"})]}),e.jsx(T,{})]}),e.jsx(m,{children:e.jsxs("div",{children:[e.jsx("h1",{children:"Profile"}),e.jsx("p",{children:"You need to login to see the secret message"}),e.jsx(j,{})]})})]})}export{M as Profile,M as default};
