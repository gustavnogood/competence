import{u as p,A as g,g as f,j as e}from"./index-Dm76dRK7.js";import{r as u}from"./react-Da8D78aN.js";import{A as m,U as x}from"./UnauthenticatedTemplate-CopvHW7t.js";import j from"./Login-BG-1mV4d.js";import{a as A}from"./axiosInstance-Dgkebl2b.js";import"./axios-Bo0ATomq.js";/*! @azure/msal-react v2.0.12 2024-02-17 */function h(s,n){return!n||!n.homeAccountId&&!n.localAccountId&&!n.username?s.getActiveAccount():f(s.getAllAccounts(),n)}function y(s){const{instance:n,inProgress:c,logger:i}=p(),[t,d]=u.useState(()=>h(n,s));return u.useEffect(()=>{d(a=>{const l=h(n,s);return g.accountInfoIsEqual(a,l,!0)?a:(i.info("useAccount - Updating account"),l)})},[c,s,n,i]),t}const E="_Container_1rrod_1",T={Container:E};function v({inProgress:s,accounts:n}){return n.length>0?e.jsxs("span",{children:["There are currently ",n.length," users signed in!"]}):s==="login"?e.jsx("span",{children:"Login is currently in progress!"}):e.jsx("span",{children:"There are currently no users signed in!"})}function D({apiData:s,addUserToDB:n}){return e.jsxs("div",{children:[s&&e.jsxs("p",{children:["Display Name: ",s.displayName," ",e.jsx("br",{}),"ID: ",s.id]}),e.jsx("button",{onClick:n,children:"Add user to DB"})]})}function P(){const{instance:s,accounts:n,inProgress:c}=p(),i=y(n[0]||{}),[t,d]=u.useState(null);function a(o){return fetch("https://graph.microsoft.com/v1.0/me",{headers:{Authorization:`Bearer ${o}`}}).then(r=>r.json()).catch(r=>{throw console.error("Error calling Microsoft Graph API:",r),r})}function l(){let o;t&&t.id&&t.displayName&&(o={id:t.id,displayName:t.displayName}),o?(console.log(o),A.post("users",o).then(r=>console.log(r)).catch(r=>console.error("Error adding user to DB:",r.response.data))):console.error("invalid apiData:",t)}return u.useEffect(()=>{i&&s.acquireTokenSilent({scopes:["User.Read"],account:i}).then(o=>{o&&a(o.accessToken).then(r=>d(r))})},[i,s]),n.length>0?e.jsxs("div",{className:T.Container,children:[e.jsx(v,{inProgress:c,accounts:n}),e.jsx(D,{apiData:t,addUserToDB:l})]}):c==="login"?e.jsx("span",{children:"Login is currently in progress!"}):e.jsx("span",{children:"There are currently no users signed in!"})}function S(){return e.jsxs(e.Fragment,{children:[e.jsxs(m,{children:[e.jsxs("div",{children:[e.jsx("h1",{children:"Profile"}),e.jsx("p",{children:"Welcome to your profile!"})]}),e.jsx(P,{})]}),e.jsx(x,{children:e.jsxs("div",{children:[e.jsx("h1",{children:"Profile"}),e.jsx("p",{children:"You need to login to see the secret message"}),e.jsx(j,{})]})})]})}export{S as Profile,S as default};
